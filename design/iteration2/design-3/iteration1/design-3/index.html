<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Progress Dashboard - Shopping List</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #121216;
    --surface: rgba(255,255,255,0.04);
    --teal: #4E9DA6;
    --teal-glow: 0 0 15px rgba(78,157,166,0.4), 0 0 30px rgba(78,157,166,0.15);
    --orange: #E8923A;
    --orange-glow: 0 0 12px rgba(232,146,58,0.5);
    --text-primary: #ffffff;
    --text-secondary: rgba(255,255,255,0.5);
    --text-dim: rgba(255,255,255,0.35);
    --green: #6BBF6B;
    --blue: #5BA8D5;
    --yellow: #E8C44A;
    --red: #E07B7B;
    --purple: #A07BCC;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
  }

  body {
    background: #0a0a0e;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: var(--text-primary);
  }

  .phone-frame {
    width: 390px;
    height: 844px;
    background: var(--bg);
    border-radius: 44px;
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow: 0 0 60px rgba(0,0,0,0.5), 0 0 120px rgba(78,157,166,0.05);
  }

  .screen {
    height: 100%;
    overflow-y: auto;
    overflow-x: hidden;
    padding-bottom: 100px;
    scrollbar-width: none;
  }

  .screen::-webkit-scrollbar {
    display: none;
  }

  /* Status Bar */
  .status-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 28px 8px;
    position: sticky;
    top: 0;
    z-index: 50;
    background: var(--bg);
  }

  .status-time {
    font-size: 15px;
    font-weight: 700;
    letter-spacing: 0.5px;
  }

  .status-icons {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .status-icons svg {
    width: 16px;
    height: 16px;
    fill: white;
  }

  /* Header */
  .header {
    text-align: center;
    padding: 16px 24px 20px;
  }

  .logo-wrapper {
    margin-bottom: 16px;
  }

  .logo-wrapper img {
    height: 32px;
    filter: drop-shadow(0 0 10px rgba(78,157,166,0.3));
  }

  .header-title {
    font-size: 24px;
    font-weight: 800;
    color: var(--text-primary);
    margin-bottom: 4px;
    letter-spacing: -0.3px;
  }

  .header-subtitle {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-dim);
  }

  /* Progress Summary Card */
  .progress-section {
    padding: 0 20px;
    margin-bottom: 24px;
  }

  .progress-card {
    position: relative;
    border-radius: 22px;
    padding: 18px;
    background: rgba(255,255,255,0.03);
    overflow: hidden;
  }

  .progress-card::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 22px;
    padding: 1px;
    background: linear-gradient(135deg, var(--teal), var(--orange));
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }

  .progress-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 14px;
  }

  .progress-title {
    font-size: 16px;
    font-weight: 700;
    color: var(--text-primary);
  }

  .progress-badge {
    background: var(--orange);
    color: #fff;
    font-size: 12px;
    font-weight: 700;
    padding: 4px 12px;
    border-radius: 20px;
    box-shadow: var(--orange-glow);
    animation: pulseOrange 2s ease-in-out infinite;
  }

  @keyframes pulseOrange {
    0%, 100% {
      box-shadow: 0 0 8px rgba(232,146,58,0.3);
    }
    50% {
      box-shadow: 0 0 18px rgba(232,146,58,0.6), 0 0 30px rgba(232,146,58,0.2);
    }
  }

  /* Segmented Progress Bar */
  .progress-bar-track {
    width: 100%;
    height: 8px;
    background: rgba(255,255,255,0.06);
    border-radius: 4px;
    overflow: hidden;
    display: flex;
    margin-bottom: 10px;
  }

  .progress-segment {
    height: 100%;
    transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
  }

  .progress-segment.green {
    background: var(--green);
    box-shadow: 0 0 8px rgba(107,191,107,0.4);
  }

  .progress-segment.blue {
    background: var(--blue);
    box-shadow: 0 0 8px rgba(91,168,213,0.4);
  }

  .progress-segment.yellow {
    background: var(--yellow);
    box-shadow: 0 0 8px rgba(232,196,74,0.4);
  }

  .progress-segment.red {
    background: var(--red);
    box-shadow: 0 0 8px rgba(224,123,123,0.4);
  }

  .progress-segment.purple {
    background: var(--purple);
    box-shadow: 0 0 8px rgba(160,123,204,0.4);
  }

  .progress-segment:first-child {
    border-radius: 4px 0 0 4px;
  }

  .progress-segment:last-child {
    border-radius: 0 4px 4px 0;
  }

  .progress-segment:only-child {
    border-radius: 4px;
  }

  .progress-legend {
    display: flex;
    align-items: center;
    gap: 4px;
    flex-wrap: wrap;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 3px;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-dim);
  }

  .legend-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .legend-dot.green { background: var(--green); }
  .legend-dot.blue { background: var(--blue); }
  .legend-dot.yellow { background: var(--yellow); }
  .legend-dot.red { background: var(--red); }
  .legend-dot.purple { background: var(--purple); }

  .legend-separator {
    color: rgba(255,255,255,0.15);
    font-size: 11px;
    margin: 0 1px;
  }

  /* Category Cards */
  .categories-section {
    padding: 0 20px;
  }

  .categories-label {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 1.2px;
    margin-bottom: 14px;
  }

  .category-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .category-card {
    display: flex;
    align-items: center;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 22px;
    padding: 16px 18px;
    text-decoration: none;
    color: inherit;
    transition: all 0.25s ease;
    cursor: pointer;
  }

  .category-card:hover {
    background: rgba(255,255,255,0.06);
    transform: translateY(-1px);
  }

  .category-card:active {
    transform: scale(0.98);
  }

  .category-icon {
    width: 52px;
    height: 52px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    flex-shrink: 0;
    margin-right: 14px;
  }

  .category-icon.green {
    background: rgba(107,191,107,0.12);
    box-shadow: 0 0 20px rgba(107,191,107,0.3);
  }

  .category-icon.blue {
    background: rgba(91,168,213,0.12);
    box-shadow: 0 0 20px rgba(91,168,213,0.3);
  }

  .category-icon.yellow {
    background: rgba(232,196,74,0.12);
    box-shadow: 0 0 20px rgba(232,196,74,0.3);
  }

  .category-icon.red {
    background: rgba(224,123,123,0.12);
    box-shadow: 0 0 20px rgba(224,123,123,0.3);
  }

  .category-icon.purple {
    background: rgba(160,123,204,0.12);
    box-shadow: 0 0 20px rgba(160,123,204,0.3);
  }

  .category-info {
    flex: 1;
    min-width: 0;
  }

  .category-name {
    font-size: 15px;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 2px;
  }

  .category-count {
    font-size: 12px;
    font-weight: 500;
    color: var(--text-dim);
    margin-bottom: 5px;
  }

  .category-emoji-preview {
    display: flex;
    gap: 3px;
    flex-wrap: wrap;
    line-height: 1;
  }

  .category-emoji-preview span {
    font-size: 16px;
    line-height: 1;
    opacity: 0.85;
    transition: opacity 0.2s;
  }

  .category-right {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
    margin-left: 8px;
  }

  /* Progress Ring */
  .progress-ring-wrapper {
    width: 36px;
    height: 36px;
    position: relative;
    flex-shrink: 0;
  }

  .progress-ring-wrapper svg {
    width: 36px;
    height: 36px;
    transform: rotate(-90deg);
  }

  .progress-ring-track {
    fill: none;
    stroke: rgba(255,255,255,0.08);
    stroke-width: 3;
  }

  .progress-ring-fill {
    fill: none;
    stroke: var(--teal);
    stroke-width: 3;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .progress-ring-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 9px;
    font-weight: 700;
    color: var(--text-secondary);
    line-height: 1;
  }

  .category-chevron {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.4;
  }

  .category-chevron svg {
    width: 14px;
    height: 14px;
  }

  /* Bottom Nav */
  .bottom-nav {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(18,18,22,0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255,255,255,0.06);
    display: flex;
    justify-content: space-around;
    align-items: flex-start;
    padding: 12px 16px 32px;
    z-index: 100;
  }

  .nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    text-decoration: none;
    color: var(--text-dim);
    font-size: 10px;
    font-weight: 600;
    position: relative;
    cursor: pointer;
    transition: color 0.2s;
    min-width: 56px;
  }

  .nav-item.active {
    color: var(--teal);
  }

  .nav-item.active::after {
    content: '';
    position: absolute;
    top: -12px;
    left: 50%;
    transform: translateX(-50%);
    width: 24px;
    height: 3px;
    background: var(--teal);
    border-radius: 2px;
    box-shadow: var(--teal-glow);
  }

  .nav-item svg {
    width: 24px;
    height: 24px;
    fill: currentColor;
  }

  .nav-badge {
    position: absolute;
    top: -4px;
    right: 4px;
    width: 18px;
    height: 18px;
    background: var(--orange);
    color: #fff;
    font-size: 10px;
    font-weight: 700;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: var(--orange-glow);
    animation: pulseOrange 2s ease-in-out infinite;
  }
</style>
</head>
<body>

<div class="phone-frame">
  <div class="screen">
    <!-- Status Bar -->
    <div class="status-bar">
      <div class="status-time">9:41</div>
      <div class="status-icons">
        <svg viewBox="0 0 16 16"><path d="M1.5 4.5C4 2 7.5 1 8 1s4 1 6.5 3.5l-1.2 1.2C11.2 3.6 9 2.5 8 2.5S4.8 3.6 2.7 5.7L1.5 4.5zM4 7.3C5.3 6 6.8 5.2 8 5.2s2.7.8 4 2.1L10.8 8.5C9.8 7.5 9 7 8 7s-1.8.5-2.8 1.5L4 7.3zM6.5 10c.8-.8 1.2-1 1.5-1s.7.2 1.5 1L8 11.5 6.5 10z"/></svg>
        <svg viewBox="0 0 16 16"><path d="M1 4h2v8H1V4zm3.5 2h2v6h-2V6zM8 3h2v9H8V3zm3.5 1h2v8h-2V4z"/></svg>
        <svg viewBox="0 0 24 14"><rect x="0.5" y="0.5" width="20" height="13" rx="2.5" stroke="white" stroke-opacity="0.35" fill="none"/><path opacity="0.4" d="M22 5v4a2 2 0 000-4z" fill="white"/><rect x="2" y="2" width="15" height="9" rx="1.5" fill="white"/></svg>
      </div>
    </div>

    <!-- Header -->
    <div class="header">
      <div class="logo-wrapper">
        <img src="../../../../shopzebra-logo.png" alt="ShopZebra">
      </div>
      <h1 class="header-title">REWE Wocheneinkauf</h1>
      <p class="header-subtitle">Familien-Einkauf &middot; 3 Personen</p>
    </div>

    <!-- Progress Summary -->
    <div class="progress-section">
      <div class="progress-card">
        <div class="progress-header">
          <span class="progress-title" id="progressTitle">22 Artikel ausgew&auml;hlt</span>
          <span class="progress-badge" id="progressBadge">22</span>
        </div>
        <div class="progress-bar-track" id="progressBar"></div>
        <div class="progress-legend" id="progressLegend"></div>
      </div>
    </div>

    <!-- Categories -->
    <div class="categories-section">
      <div class="categories-label">Kategorien</div>
      <div class="category-list" id="categoryList">

        <a class="category-card" href="kategorie.html" data-cat="obst-gemuese">
          <div class="category-icon green">üçé</div>
          <div class="category-info">
            <div class="category-name">Obst & Gem&uuml;se</div>
            <div class="category-count" data-cat-count="obst-gemuese">21 Produkte</div>
            <div class="category-emoji-preview" data-cat-preview="obst-gemuese"></div>
          </div>
          <div class="category-right">
            <div class="progress-ring-wrapper" data-cat-ring="obst-gemuese">
              <svg viewBox="0 0 36 36">
                <circle class="progress-ring-track" cx="18" cy="18" r="14"/>
                <circle class="progress-ring-fill" cx="18" cy="18" r="14" stroke-dasharray="88" stroke-dashoffset="88"/>
              </svg>
              <span class="progress-ring-text">0%</span>
            </div>
            <div class="category-chevron">
              <svg viewBox="0 0 14 14" fill="none" stroke="#6BBF6B" stroke-width="2" stroke-linecap="round"><path d="M5 2l5 5-5 5"/></svg>
            </div>
          </div>
        </a>

        <a class="category-card" href="kategorie.html" data-cat="milch-kaese">
          <div class="category-icon blue">üßÄ</div>
          <div class="category-info">
            <div class="category-name">Milch & K&auml;se</div>
            <div class="category-count" data-cat-count="milch-kaese">14 Produkte</div>
            <div class="category-emoji-preview" data-cat-preview="milch-kaese"></div>
          </div>
          <div class="category-right">
            <div class="progress-ring-wrapper" data-cat-ring="milch-kaese">
              <svg viewBox="0 0 36 36">
                <circle class="progress-ring-track" cx="18" cy="18" r="14"/>
                <circle class="progress-ring-fill" cx="18" cy="18" r="14" stroke-dasharray="88" stroke-dashoffset="88"/>
              </svg>
              <span class="progress-ring-text">0%</span>
            </div>
            <div class="category-chevron">
              <svg viewBox="0 0 14 14" fill="none" stroke="#5BA8D5" stroke-width="2" stroke-linecap="round"><path d="M5 2l5 5-5 5"/></svg>
            </div>
          </div>
        </a>

        <a class="category-card" href="kategorie.html" data-cat="brot-gebaeck">
          <div class="category-icon yellow">üçû</div>
          <div class="category-info">
            <div class="category-name">Brot & Geb&auml;ck</div>
            <div class="category-count" data-cat-count="brot-gebaeck">9 Produkte</div>
            <div class="category-emoji-preview" data-cat-preview="brot-gebaeck"></div>
          </div>
          <div class="category-right">
            <div class="progress-ring-wrapper" data-cat-ring="brot-gebaeck">
              <svg viewBox="0 0 36 36">
                <circle class="progress-ring-track" cx="18" cy="18" r="14"/>
                <circle class="progress-ring-fill" cx="18" cy="18" r="14" stroke-dasharray="88" stroke-dashoffset="88"/>
              </svg>
              <span class="progress-ring-text">0%</span>
            </div>
            <div class="category-chevron">
              <svg viewBox="0 0 14 14" fill="none" stroke="#E8C44A" stroke-width="2" stroke-linecap="round"><path d="M5 2l5 5-5 5"/></svg>
            </div>
          </div>
        </a>

        <a class="category-card" href="kategorie.html" data-cat="fleisch-fisch">
          <div class="category-icon red">ü•©</div>
          <div class="category-info">
            <div class="category-name">Fleisch & Fisch</div>
            <div class="category-count" data-cat-count="fleisch-fisch">12 Produkte</div>
            <div class="category-emoji-preview" data-cat-preview="fleisch-fisch"></div>
          </div>
          <div class="category-right">
            <div class="progress-ring-wrapper" data-cat-ring="fleisch-fisch">
              <svg viewBox="0 0 36 36">
                <circle class="progress-ring-track" cx="18" cy="18" r="14"/>
                <circle class="progress-ring-fill" cx="18" cy="18" r="14" stroke-dasharray="88" stroke-dashoffset="88"/>
              </svg>
              <span class="progress-ring-text">0%</span>
            </div>
            <div class="category-chevron">
              <svg viewBox="0 0 14 14" fill="none" stroke="#E07B7B" stroke-width="2" stroke-linecap="round"><path d="M5 2l5 5-5 5"/></svg>
            </div>
          </div>
        </a>

        <a class="category-card" href="kategorie.html" data-cat="zutaten-gewuerze">
          <div class="category-icon purple">üßÇ</div>
          <div class="category-info">
            <div class="category-name">Zutaten & Gew&uuml;rze</div>
            <div class="category-count" data-cat-count="zutaten-gewuerze">18 Produkte</div>
            <div class="category-emoji-preview" data-cat-preview="zutaten-gewuerze"></div>
          </div>
          <div class="category-right">
            <div class="progress-ring-wrapper" data-cat-ring="zutaten-gewuerze">
              <svg viewBox="0 0 36 36">
                <circle class="progress-ring-track" cx="18" cy="18" r="14"/>
                <circle class="progress-ring-fill" cx="18" cy="18" r="14" stroke-dasharray="88" stroke-dashoffset="88"/>
              </svg>
              <span class="progress-ring-text">0%</span>
            </div>
            <div class="category-chevron">
              <svg viewBox="0 0 14 14" fill="none" stroke="#A07BCC" stroke-width="2" stroke-linecap="round"><path d="M5 2l5 5-5 5"/></svg>
            </div>
          </div>
        </a>

      </div>
    </div>
  </div>

  <!-- Bottom Nav -->
  <div class="bottom-nav">
    <a class="nav-item active" href="#">
      <svg viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>
      <span>Listen</span>
    </a>
    <a class="nav-item" href="#">
      <svg viewBox="0 0 24 24"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
      <span>Planen</span>
    </a>
    <a class="nav-item" href="#">
      <svg viewBox="0 0 24 24"><path d="M8.1 13.34l2.83-2.83L3.91 3.5a4.008 4.008 0 000 5.66l4.19 4.18zm6.78-1.81c1.53.71 3.68.21 5.27-1.38 1.91-1.91 2.28-4.65.81-6.12-1.46-1.46-4.2-1.1-6.12.81-1.59 1.59-2.09 3.74-1.38 5.27L3.7 19.87l1.41 1.41L12 14.41l6.88 6.88 1.41-1.41L13.41 13l1.47-1.47z"/></svg>
      <span>Rezepte</span>
    </a>
    <a class="nav-item" href="#">
      <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/></svg>
      <span>Aktivit&auml;t</span>
      <div class="nav-badge">3</div>
    </a>
  </div>
</div>

<script>
  const STORAGE_KEY = 'shopzebra_items_v2';

  const DEFAULT_ITEMS = [
    { id: 'aepfel', emoji: '\u{1F34E}', name: '√Ñpfel', qty: 2, unit: 'kg', cat: 'obst-gemuese' },
    { id: 'bananen', emoji: '\u{1F34C}', name: 'Bananen', qty: 6, unit: 'St', cat: 'obst-gemuese' },
    { id: 'tomaten', emoji: '\u{1F345}', name: 'Tomaten', qty: 1, unit: 'kg', cat: 'obst-gemuese' },
    { id: 'kartoffeln', emoji: '\u{1F954}', name: 'Kartoffeln', qty: 2, unit: 'kg', cat: 'obst-gemuese' },
    { id: 'gurke', emoji: '\u{1F952}', name: 'Gurke', qty: 2, unit: 'St', cat: 'obst-gemuese' },
    { id: 'paprika', emoji: '\u{1FAD1}', name: 'Paprika', qty: 3, unit: 'St', cat: 'obst-gemuese' },
    { id: 'zwiebeln', emoji: '\u{1F9C5}', name: 'Zwiebeln', qty: 1, unit: 'Netz', cat: 'obst-gemuese' },
    { id: 'salat', emoji: '\u{1F96C}', name: 'Salat', qty: 1, unit: 'Kopf', cat: 'obst-gemuese' },
    { id: 'milch', emoji: '\u{1F95B}', name: 'Milch', qty: 2, unit: 'L', cat: 'milch-kaese' },
    { id: 'gouda', emoji: '\u{1F9C0}', name: 'Gouda', qty: 1, unit: 'Pck', cat: 'milch-kaese' },
    { id: 'jogurt', emoji: '\u{1F95B}', name: 'Joghurt', qty: 4, unit: 'St', cat: 'milch-kaese' },
    { id: 'butter', emoji: '\u{1F9C8}', name: 'Butter', qty: 1, unit: 'St', cat: 'milch-kaese' },
    { id: 'vollkornbrot', emoji: '\u{1F35E}', name: 'Vollkornbrot', qty: 1, unit: 'St', cat: 'brot-gebaeck' },
    { id: 'broetchen', emoji: '\u{1F950}', name: 'Br√∂tchen', qty: 6, unit: 'St', cat: 'brot-gebaeck' },
    { id: 'hackfleisch', emoji: '\u{1F969}', name: 'Hackfleisch', qty: 1, unit: '500g', cat: 'fleisch-fisch' },
    { id: 'haehnchen', emoji: '\u{1F357}', name: 'H√§hnchenbrust', qty: 1, unit: '400g', cat: 'fleisch-fisch' },
    { id: 'lachs', emoji: '\u{1F41F}', name: 'Lachs', qty: 1, unit: '200g', cat: 'fleisch-fisch' },
    { id: 'nudeln', emoji: '\u{1F35D}', name: 'Nudeln', qty: 2, unit: 'Pck', cat: 'zutaten-gewuerze' },
    { id: 'reis', emoji: '\u{1F35A}', name: 'Reis', qty: 1, unit: 'Pck', cat: 'zutaten-gewuerze' },
    { id: 'olivenoel', emoji: '\u{1FAD2}', name: 'Oliven√∂l', qty: 1, unit: 'Fl', cat: 'zutaten-gewuerze' },
    { id: 'passierte-tomaten', emoji: '\u{1F96B}', name: 'Passierte Tomaten', qty: 2, unit: 'Pck', cat: 'zutaten-gewuerze' },
    { id: 'sojasauce', emoji: '\u{1F962}', name: 'Sojasauce', qty: 1, unit: 'Fl', cat: 'zutaten-gewuerze' }
  ];

  const CATEGORY_TOTALS = {
    'obst-gemuese': 21,
    'milch-kaese': 14,
    'brot-gebaeck': 9,
    'fleisch-fisch': 12,
    'zutaten-gewuerze': 18
  };

  const CATEGORY_COLORS = {
    'obst-gemuese': 'green',
    'milch-kaese': 'blue',
    'brot-gebaeck': 'yellow',
    'fleisch-fisch': 'red',
    'zutaten-gewuerze': 'purple'
  };

  const CATEGORY_NAMES = {
    'obst-gemuese': 'Obst',
    'milch-kaese': 'Milch',
    'brot-gebaeck': 'Brot',
    'fleisch-fisch': 'Fleisch',
    'zutaten-gewuerze': 'Zutaten'
  };

  const CIRCUMFERENCE = 2 * Math.PI * 14; // ~87.96

  function loadItems() {
    const stored = localStorage.getItem(STORAGE_KEY);
    if (!stored) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(DEFAULT_ITEMS));
      return [...DEFAULT_ITEMS];
    }
    const parsed = JSON.parse(stored);
    return parsed.length > 0 ? parsed : DEFAULT_ITEMS;
  }

  function getCategoryCounts(items) {
    const counts = {};
    const catIds = Object.keys(CATEGORY_TOTALS);
    catIds.forEach(cat => {
      counts[cat] = items.filter(item => item.cat === cat);
    });
    return counts;
  }

  function renderProgressBar(categoryCounts) {
    const bar = document.getElementById('progressBar');
    const legend = document.getElementById('progressLegend');
    const totalItems = Object.values(categoryCounts).reduce((sum, arr) => sum + arr.length, 0);

    if (totalItems === 0) {
      bar.innerHTML = '';
      legend.innerHTML = '<span class="legend-item" style="color: var(--text-dim);">Noch keine Artikel</span>';
      return;
    }

    const catOrder = ['obst-gemuese', 'milch-kaese', 'brot-gebaeck', 'fleisch-fisch', 'zutaten-gewuerze'];
    let barHTML = '';
    let legendHTML = '';

    catOrder.forEach((cat, index) => {
      const count = categoryCounts[cat].length;
      if (count === 0) return;

      const widthPercent = (count / totalItems) * 100;
      barHTML += `<div class="progress-segment ${CATEGORY_COLORS[cat]}" style="width: ${widthPercent}%"></div>`;

      if (legendHTML.length > 0) {
        legendHTML += '<span class="legend-separator">+</span>';
      }
      legendHTML += `<span class="legend-item"><span class="legend-dot ${CATEGORY_COLORS[cat]}"></span>${count}</span>`;
    });

    legendHTML += `<span class="legend-item" style="margin-left: 4px; color: var(--text-secondary);">= ${totalItems} Artikel</span>`;

    bar.innerHTML = barHTML;
    legend.innerHTML = legendHTML;
  }

  function renderProgressRing(cat, selectedCount, totalCount) {
    const wrapper = document.querySelector(`[data-cat-ring="${cat}"]`);
    if (!wrapper) return;

    const fillCircle = wrapper.querySelector('.progress-ring-fill');
    const textEl = wrapper.querySelector('.progress-ring-text');

    const ratio = totalCount > 0 ? selectedCount / totalCount : 0;
    const offset = CIRCUMFERENCE - (CIRCUMFERENCE * ratio);
    const percentage = Math.round(ratio * 100);

    fillCircle.style.strokeDashoffset = offset;
    textEl.textContent = `${percentage}%`;
  }

  function renderEmojiPreviews(cat, catItems) {
    const previewEl = document.querySelector(`[data-cat-preview="${cat}"]`);
    if (!previewEl) return;

    if (catItems.length === 0) {
      previewEl.innerHTML = '';
      return;
    }

    previewEl.innerHTML = catItems.map(item => `<span>${item.emoji}</span>`).join('');
  }

  function renderCategoryCounts(categoryCounts) {
    const catOrder = ['obst-gemuese', 'milch-kaese', 'brot-gebaeck', 'fleisch-fisch', 'zutaten-gewuerze'];

    catOrder.forEach(cat => {
      const countEl = document.querySelector(`[data-cat-count="${cat}"]`);
      const selectedCount = categoryCounts[cat].length;
      const totalCount = CATEGORY_TOTALS[cat];

      if (countEl) {
        countEl.textContent = `${selectedCount} gew√§hlt von ${totalCount}`;
      }

      renderProgressRing(cat, selectedCount, totalCount);
      renderEmojiPreviews(cat, categoryCounts[cat]);
    });
  }

  function renderAll() {
    const items = loadItems();
    const totalCount = items.length;
    const categoryCounts = getCategoryCounts(items);

    // Update header
    const titleEl = document.getElementById('progressTitle');
    const badgeEl = document.getElementById('progressBadge');
    titleEl.textContent = `${totalCount} Artikel ausgew√§hlt`;
    badgeEl.textContent = totalCount;

    // Render segmented bar
    renderProgressBar(categoryCounts);

    // Render category details
    renderCategoryCounts(categoryCounts);
  }

  renderAll();

  // Re-render when returning from category page
  window.addEventListener('focus', renderAll);
  window.addEventListener('pageshow', renderAll);
</script>

</body>
</html>
